# ğŸŒ ä¸­åŒ»çŸ¥è¯†å›¾è°±ç½‘ç«™å…¬ç½‘éƒ¨ç½²æŒ‡å—

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å°†ä¸­åŒ»çŸ¥è¯†å›¾è°±ç½‘ç«™éƒ¨ç½²åˆ°å…¬ç½‘ï¼Œè®©å…¶ä»–äººå¯ä»¥é€šè¿‡äº’è”ç½‘è®¿é—®ã€‚

## ğŸ“‹ éƒ¨ç½²æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ | æˆæœ¬ |
|------|------|------|----------|------|
| **æ–¹æ¡ˆä¸€ï¼šå…è´¹äº‘å¹³å°** | å…è´¹ã€ç®€å•ã€å¿«é€Ÿ | æœ‰ä½¿ç”¨é™åˆ¶ | ä¸ªäººé¡¹ç›®ã€æ¼”ç¤º | å…è´¹ |
| **æ–¹æ¡ˆäºŒï¼šäº‘æœåŠ¡å™¨** | å®Œå…¨æ§åˆ¶ã€æ€§èƒ½å¥½ | éœ€è¦é…ç½®ã€éœ€ä»˜è´¹ | æ­£å¼é¡¹ç›® | Â¥50-500/æœˆ |
| **æ–¹æ¡ˆä¸‰ï¼šå†…ç½‘ç©¿é€** | æ— éœ€æœåŠ¡å™¨ã€å¿«é€Ÿ | ä¸ç¨³å®šã€æœ‰æµé‡é™åˆ¶ | ä¸´æ—¶æ¼”ç¤º | å…è´¹/ä»˜è´¹ |

---

## ğŸš€ æ–¹æ¡ˆä¸€ï¼šå…è´¹äº‘å¹³å°éƒ¨ç½²ï¼ˆæ¨èæ–°æ‰‹ï¼‰

### 1.1 å‰ç«¯éƒ¨ç½² - Vercelï¼ˆæ¨èï¼‰

**ä¼˜ç‚¹ï¼š** å…è´¹ã€è‡ªåŠ¨HTTPSã€å…¨çƒCDNã€è‡ªåŠ¨éƒ¨ç½²

#### æ­¥éª¤ï¼š

1. **å‡†å¤‡å‰ç«¯æ„å»ºæ–‡ä»¶**
   ```bash
   cd tcm-knowledge-graph/frontend
   npm install
   npm run build
   ```
   æ„å»ºå®Œæˆåï¼Œ`frontend/dist` ç›®å½•å°±æ˜¯å‰ç«¯é™æ€æ–‡ä»¶ã€‚

2. **æ³¨å†ŒVercelè´¦å·**
   - è®¿é—®ï¼šhttps://vercel.com
   - ä½¿ç”¨GitHubè´¦å·ç™»å½•ï¼ˆæ¨èï¼‰

3. **éƒ¨ç½²å‰ç«¯**
   - ç‚¹å‡» "New Project"
   - é€‰æ‹©æ‚¨çš„Gitä»“åº“ï¼Œæˆ–ç›´æ¥ä¸Šä¼  `frontend/dist` æ–‡ä»¶å¤¹
   - é…ç½®ï¼š
     - **Framework Preset**: Vite
     - **Root Directory**: frontend
     - **Build Command**: `npm run build`
     - **Output Directory**: dist
   - ç‚¹å‡» Deploy

4. **é…ç½®ç¯å¢ƒå˜é‡**
   - åœ¨Vercelé¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ï¼š
     ```
     VITE_API_URL=https://your-backend-url.com/api
     ```

5. **è·å–å‰ç«¯åœ°å€**
   - éƒ¨ç½²å®Œæˆåä¼šè·å¾—ç±»ä¼¼ï¼š`https://your-project.vercel.app`

### 1.2 åç«¯éƒ¨ç½² - Railwayï¼ˆæ¨èï¼‰

**ä¼˜ç‚¹ï¼š** å…è´¹é¢åº¦ã€è‡ªåŠ¨éƒ¨ç½²ã€ç®€å•é…ç½®

#### æ­¥éª¤ï¼š

1. **æ³¨å†ŒRailwayè´¦å·**
   - è®¿é—®ï¼šhttps://railway.app
   - ä½¿ç”¨GitHubè´¦å·ç™»å½•

2. **åˆ›å»ºæ–°é¡¹ç›®**
   - ç‚¹å‡» "New Project"
   - é€‰æ‹© "Deploy from GitHub repo" æˆ– "Empty Project"

3. **é…ç½®åç«¯æœåŠ¡**
   - åœ¨é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ï¼š
     ```env
     NODE_ENV=production
     PORT=3001
     NEO4J_URI=neo4j+s://your-neo4j-uri
     NEO4J_USER=neo4j
     NEO4J_PASSWORD=your-password
     FRONTEND_URL=https://your-frontend.vercel.app
     ```

4. **éƒ¨ç½²åç«¯**
   - å¦‚æœä½¿ç”¨GitHubï¼ŒRailwayä¼šè‡ªåŠ¨æ£€æµ‹å¹¶éƒ¨ç½²
   - æˆ–æ‰‹åŠ¨ä¸Šä¼  `backend` æ–‡ä»¶å¤¹
   - Railwayä¼šè‡ªåŠ¨å®‰è£…ä¾èµ–å¹¶å¯åŠ¨æœåŠ¡

5. **è·å–åç«¯åœ°å€**
   - éƒ¨ç½²å®Œæˆåä¼šè·å¾—ç±»ä¼¼ï¼š`https://your-project.up.railway.app`

### 1.3 å…¶ä»–å…è´¹å¹³å°é€‰æ‹©

**å‰ç«¯ï¼š**
- **Netlify**: https://netlify.comï¼ˆç±»ä¼¼Vercelï¼‰
- **GitHub Pages**: https://pages.github.comï¼ˆä»…é™æ€ç½‘ç«™ï¼‰

**åç«¯ï¼š**
- **Render**: https://render.comï¼ˆç±»ä¼¼Railwayï¼‰
- **Fly.io**: https://fly.ioï¼ˆæ”¯æŒDockerï¼‰

---

## ğŸ–¥ï¸ æ–¹æ¡ˆäºŒï¼šäº‘æœåŠ¡å™¨éƒ¨ç½²ï¼ˆæ¨èæ­£å¼é¡¹ç›®ï¼‰

### 2.1 è´­ä¹°äº‘æœåŠ¡å™¨

**æ¨èæœåŠ¡å•†ï¼š**
- **é˜¿é‡Œäº‘**ï¼šhttps://www.aliyun.comï¼ˆå›½å†…è®¿é—®å¿«ï¼‰
- **è…¾è®¯äº‘**ï¼šhttps://cloud.tencent.comï¼ˆæ€§ä»·æ¯”é«˜ï¼‰
- **åä¸ºäº‘**ï¼šhttps://www.huaweicloud.com
- **AWS/Google Cloud**ï¼šé€‚åˆæµ·å¤–ç”¨æˆ·

**é…ç½®å»ºè®®ï¼š**
- CPU: 2æ ¸
- å†…å­˜: 4GB
- å¸¦å®½: 3-5Mbps
- ç³»ç»Ÿ: Ubuntu 22.04 LTS

### 2.2 æœåŠ¡å™¨ç¯å¢ƒé…ç½®

#### 1. è¿æ¥æœåŠ¡å™¨
```bash
ssh root@your-server-ip
```

#### 2. å®‰è£…Node.js
```bash
# ä½¿ç”¨NodeSourceå®‰è£…Node.js 18
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs

# éªŒè¯å®‰è£…
node -v
npm -v
```

#### 3. å®‰è£…Nginx
```bash
sudo apt update
sudo apt install nginx -y
sudo systemctl start nginx
sudo systemctl enable nginx
```

#### 4. å®‰è£…PM2ï¼ˆè¿›ç¨‹ç®¡ç†ï¼‰
```bash
sudo npm install -g pm2
```

### 2.3 éƒ¨ç½²é¡¹ç›®

#### 1. ä¸Šä¼ é¡¹ç›®æ–‡ä»¶
```bash
# æ–¹å¼ä¸€ï¼šä½¿ç”¨Git
cd /opt
git clone your-repo-url tcm-knowledge-graph
cd tcm-knowledge-graph

# æ–¹å¼äºŒï¼šä½¿ç”¨SCPï¼ˆä»æœ¬åœ°ï¼‰
# åœ¨æœ¬åœ°æ‰§è¡Œï¼š
# scp -r tcm-knowledge-graph root@your-server-ip:/opt/
```

#### 2. æ„å»ºå‰ç«¯
```bash
cd frontend
npm install
npm run build
```

#### 3. é…ç½®åç«¯
```bash
cd ../backend
npm install
npm run build

# åˆ›å»º.envæ–‡ä»¶
nano .env
```

`.env` å†…å®¹ï¼š
```env
NODE_ENV=production
PORT=3001
NEO4J_URI=neo4j+s://your-neo4j-uri
NEO4J_USER=neo4j
NEO4J_PASSWORD=your-password
FRONTEND_URL=http://your-domain.com
```

#### 4. å¯åŠ¨åç«¯æœåŠ¡
```bash
# ä½¿ç”¨PM2å¯åŠ¨
pm2 start dist/app.js --name tcm-backend
pm2 save
pm2 startup  # è®¾ç½®å¼€æœºè‡ªå¯
```

#### 5. é…ç½®Nginx

åˆ›å»ºé…ç½®æ–‡ä»¶ï¼š
```bash
sudo nano /etc/nginx/sites-available/tcm-kg
```

å†…å®¹ï¼š
```nginx
server {
    listen 80;
    server_name your-domain.com;  # æ›¿æ¢ä¸ºæ‚¨çš„åŸŸå

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /opt/tcm-knowledge-graph/frontend/dist;
        try_files $uri $uri/ /index.html;
        index index.html;
    }

    # APIä»£ç†
    location /api {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }

    # é™æ€èµ„æºç¼“å­˜
    location ~* \.(jpg|jpeg|png|gif|ico|css|js|svg|woff|woff2|ttf|eot)$ {
        root /opt/tcm-knowledge-graph/frontend/dist;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

å¯ç”¨é…ç½®ï¼š
```bash
sudo ln -s /etc/nginx/sites-available/tcm-kg /etc/nginx/sites-enabled/
sudo nginx -t  # æµ‹è¯•é…ç½®
sudo systemctl reload nginx
```

#### 6. é…ç½®HTTPSï¼ˆå…è´¹SSLè¯ä¹¦ï¼‰

```bash
# å®‰è£…Certbot
sudo apt install certbot python3-certbot-nginx -y

# è·å–SSLè¯ä¹¦
sudo certbot --nginx -d your-domain.com

# è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run
```

#### 7. é…ç½®é˜²ç«å¢™

```bash
# å…è®¸HTTPå’ŒHTTPS
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw enable
```

### 2.4 åŸŸåé…ç½®

1. **è´­ä¹°åŸŸå**
   - é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€GoDaddyç­‰

2. **DNSè§£æ**
   - æ·»åŠ Aè®°å½•ï¼š
     - ä¸»æœºè®°å½•ï¼š@ æˆ– www
     - è®°å½•å€¼ï¼šæ‚¨çš„æœåŠ¡å™¨IP
     - TTLï¼š600

3. **ç­‰å¾…DNSç”Ÿæ•ˆ**
   - é€šå¸¸5-30åˆ†é’Ÿ

---

## ğŸ”— æ–¹æ¡ˆä¸‰ï¼šå†…ç½‘ç©¿é€ï¼ˆä¸´æ—¶æ¼”ç¤ºï¼‰

### 3.1 ä½¿ç”¨ngrokï¼ˆæœ€ç®€å•ï¼‰

1. **æ³¨å†Œè´¦å·**
   - è®¿é—®ï¼šhttps://ngrok.com
   - æ³¨å†Œå¹¶è·å–authtoken

2. **å®‰è£…ngrok**
   ```bash
   # Windows: ä¸‹è½½ https://ngrok.com/download
   # æˆ–ä½¿ç”¨chocolatey
   choco install ngrok
   ```

3. **é…ç½®**
   ```bash
   ngrok config add-authtoken your-token
   ```

4. **å¯åŠ¨ç©¿é€**
   ```bash
   # ç©¿é€åç«¯ï¼ˆç«¯å£3001ï¼‰
   ngrok http 3001
   
   # æˆ–ç©¿é€æ•´ä¸ªå‰ç«¯ï¼ˆå¦‚æœå‰ç«¯ä¹Ÿåœ¨æœ¬åœ°ï¼‰
   ngrok http 3000
   ```

5. **è·å–å…¬ç½‘åœ°å€**
   - ngrokä¼šæä¾›ä¸€ä¸ªç±»ä¼¼ï¼š`https://xxxx-xx-xx-xx-xx.ngrok-free.app`
   - è¿™ä¸ªåœ°å€å¯ä»¥å…¬ç½‘è®¿é—®

**æ³¨æ„ï¼š** å…è´¹ç‰ˆæœ‰æµé‡é™åˆ¶ï¼Œé€‚åˆä¸´æ—¶æ¼”ç¤ºã€‚

### 3.2 ä½¿ç”¨frpï¼ˆè‡ªå»ºæœåŠ¡å™¨ï¼‰

å¦‚æœæ‚¨æœ‰è‡ªå·±çš„æœåŠ¡å™¨ï¼Œå¯ä»¥ä½¿ç”¨frpï¼š

1. **æœåŠ¡å™¨ç«¯é…ç½®**
   ```bash
   # ä¸‹è½½frp
   wget https://github.com/fatedier/frp/releases/download/v0.52.3/frp_0.52.3_linux_amd64.tar.gz
   tar -xzf frp_0.52.3_linux_amd64.tar.gz
   
   # é…ç½®frps.ini
   [common]
   bind_port = 7000
   ```

2. **æœ¬åœ°é…ç½®**
   ```bash
   # é…ç½®frpc.ini
   [common]
   server_addr = your-server-ip
   server_port = 7000
   
   [web]
   type = http
   local_port = 3001
   custom_domains = your-domain.com
   ```

---

## ğŸ“ éƒ¨ç½²æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰æ£€æŸ¥
- [ ] å‰ç«¯å·²æ„å»ºï¼ˆ`frontend/dist` å­˜åœ¨ï¼‰
- [ ] åç«¯å·²æ„å»ºï¼ˆ`backend/dist` å­˜åœ¨ï¼‰
- [ ] `.env` æ–‡ä»¶å·²é…ç½®
- [ ] Neo4jè¿æ¥ä¿¡æ¯æ­£ç¡®
- [ ] åŸŸåå·²è´­ä¹°å¹¶è§£æï¼ˆå¦‚ä½¿ç”¨ï¼‰

### éƒ¨ç½²åæ£€æŸ¥
- [ ] å‰ç«¯å¯ä»¥è®¿é—®
- [ ] åç«¯APIå¯ä»¥è®¿é—®
- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] HTTPSé…ç½®æ­£ç¡®ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- [ ] é˜²ç«å¢™è§„åˆ™æ­£ç¡®
- [ ] æ—¥å¿—æ­£å¸¸

### æ€§èƒ½ä¼˜åŒ–
- [ ] å¯ç”¨Gzipå‹ç¼©
- [ ] é…ç½®CDNï¼ˆå¯é€‰ï¼‰
- [ ] å¯ç”¨ç¼“å­˜
- [ ] ç›‘æ§æœåŠ¡çŠ¶æ€

---

## ğŸ”§ å¸¸è§é—®é¢˜è§£å†³

### 1. å‰ç«¯æ— æ³•è®¿é—®åç«¯API

**é—®é¢˜ï¼š** CORSé”™è¯¯æˆ–404

**è§£å†³ï¼š**
```javascript
// æ£€æŸ¥å‰ç«¯APIé…ç½®
// frontend/src/services/api.ts
const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:3001';

// ç¡®ä¿åç«¯CORSé…ç½®æ­£ç¡®
// backend/src/app.ts
app.use(cors({
  origin: process.env.FRONTEND_URL || 'http://localhost:3000',
  credentials: true
}));
```

### 2. Neo4jè¿æ¥å¤±è´¥

**é—®é¢˜ï¼š** æ— æ³•è¿æ¥åˆ°Neo4jæ•°æ®åº“

**è§£å†³ï¼š**
- æ£€æŸ¥Neo4j URIæ ¼å¼ï¼š`neo4j+s://xxx.databases.neo4j.io`
- ç¡®è®¤ç”¨æˆ·åå¯†ç æ­£ç¡®
- æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦å…è®¸Neo4jç«¯å£
- å¦‚æœæ˜¯Neo4j Auraï¼Œç¡®è®¤IPç™½åå•è®¾ç½®

### 3. é™æ€èµ„æº404

**é—®é¢˜ï¼š** å›¾ç‰‡ã€CSSã€JSæ–‡ä»¶æ— æ³•åŠ è½½

**è§£å†³ï¼š**
- æ£€æŸ¥æ„å»ºè·¯å¾„ï¼š`vite.config.ts` ä¸­çš„ `base` é…ç½®
- ç¡®è®¤Nginxé…ç½®æ­£ç¡®
- æ£€æŸ¥æ–‡ä»¶æƒé™

### 4. æœåŠ¡è‡ªåŠ¨é‡å¯

**é—®é¢˜ï¼š** PM2æœåŠ¡é¢‘ç¹é‡å¯

**è§£å†³ï¼š**
```bash
# æŸ¥çœ‹æ—¥å¿—
pm2 logs tcm-backend

# æ£€æŸ¥é”™è¯¯
pm2 describe tcm-backend

# å¢åŠ å†…å­˜é™åˆ¶
pm2 start dist/app.js --name tcm-backend --max-memory-restart 1G
```

---

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### 1. ä½¿ç”¨PM2ç›‘æ§

```bash
# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs tcm-backend

# é‡å¯æœåŠ¡
pm2 restart tcm-backend

# æŸ¥çœ‹èµ„æºä½¿ç”¨
pm2 monit
```

### 2. ä½¿ç”¨Nginxæ—¥å¿—

```bash
# æŸ¥çœ‹è®¿é—®æ—¥å¿—
sudo tail -f /var/log/nginx/access.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log
```

### 3. è®¾ç½®è‡ªåŠ¨å¤‡ä»½

```bash
# åˆ›å»ºå¤‡ä»½è„šæœ¬
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
tar -czf /backup/tcm-kg-$DATE.tar.gz /opt/tcm-knowledge-graph

# æ·»åŠ åˆ°crontabï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹ï¼‰
0 2 * * * /path/to/backup.sh
```

---

## ğŸ¯ æ¨èéƒ¨ç½²æµç¨‹

### æ–°æ‰‹æ¨èï¼š
1. **ç¬¬ä¸€æ­¥**ï¼šä½¿ç”¨Verceléƒ¨ç½²å‰ç«¯ï¼ˆ5åˆ†é’Ÿï¼‰
2. **ç¬¬äºŒæ­¥**ï¼šä½¿ç”¨Railwayéƒ¨ç½²åç«¯ï¼ˆ10åˆ†é’Ÿï¼‰
3. **ç¬¬ä¸‰æ­¥**ï¼šé…ç½®ç¯å¢ƒå˜é‡å’ŒåŸŸå

### æ­£å¼é¡¹ç›®æ¨èï¼š
1. **ç¬¬ä¸€æ­¥**ï¼šè´­ä¹°äº‘æœåŠ¡å™¨å’ŒåŸŸå
2. **ç¬¬äºŒæ­¥**ï¼šé…ç½®æœåŠ¡å™¨ç¯å¢ƒ
3. **ç¬¬ä¸‰æ­¥**ï¼šéƒ¨ç½²é¡¹ç›®
4. **ç¬¬å››æ­¥**ï¼šé…ç½®HTTPSå’Œç›‘æ§

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š
1. æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£ï¼š`README.md`ã€`éƒ¨ç½²æŒ‡å—.md`
2. æ£€æŸ¥æ—¥å¿—æ–‡ä»¶
3. æŸ¥çœ‹äº‘å¹³å°æ–‡æ¡£
4. è”ç³»æŠ€æœ¯æ”¯æŒ

---

## ğŸ‰ éƒ¨ç½²æˆåŠŸå

æ­å–œï¼æ‚¨çš„ç½‘ç«™å·²ç»å¯ä»¥åœ¨å…¬ç½‘è®¿é—®äº†ï¼

**ä¸‹ä¸€æ­¥å¯ä»¥ï¼š**
- åˆ†äº«ç½‘ç«™é“¾æ¥ç»™æœ‹å‹
- ä¼˜åŒ–æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ
- æ·»åŠ æ›´å¤šåŠŸèƒ½
- è®¾ç½®ç›‘æ§å’Œå‘Šè­¦
- å®šæœŸå¤‡ä»½æ•°æ®

ç¥æ‚¨éƒ¨ç½²é¡ºåˆ©ï¼ğŸš€

