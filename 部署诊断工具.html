<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¬ç½‘éƒ¨ç½²è¯Šæ–­å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        .header p {
            opacity: 0.9;
            font-size: 14px;
        }
        .content {
            padding: 30px;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }
        .section h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 20px;
        }
        .input-group {
            margin-bottom: 15px;
        }
        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 500;
        }
        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }
        .result.success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            display: block;
        }
        .result.error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            display: block;
        }
        .result.warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            display: block;
        }
        .result.info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
            display: block;
        }
        .check-item {
            padding: 10px;
            margin: 8px 0;
            background: white;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .check-item .icon {
            font-size: 20px;
        }
        .check-item .text {
            flex: 1;
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
            margin-top: 10px;
        }
        .step {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }
        .step h3 {
            color: #667eea;
            margin-bottom: 8px;
        }
        .step ol {
            margin-left: 20px;
        }
        .step li {
            margin: 5px 0;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” å…¬ç½‘éƒ¨ç½²è¯Šæ–­å·¥å…·</h1>
            <p>å¸®åŠ©æ‚¨å¿«é€Ÿè¯Šæ–­å’Œä¿®å¤å…¬ç½‘éƒ¨ç½²é—®é¢˜</p>
        </div>
        <div class="content">
            <!-- æ­¥éª¤1ï¼šæ£€æŸ¥å‰ç«¯ -->
            <div class="section">
                <h2>æ­¥éª¤1ï¼šæ£€æŸ¥å‰ç«¯éƒ¨ç½²</h2>
                <div class="input-group">
                    <label>å‰ç«¯åœ°å€ï¼ˆVercelåœ°å€ï¼‰ï¼š</label>
                    <input type="text" id="frontendUrl" placeholder="https://your-project.vercel.app">
                </div>
                <button class="btn" onclick="checkFrontend()">æ£€æŸ¥å‰ç«¯</button>
                <div id="frontendResult" class="result"></div>
            </div>

            <!-- æ­¥éª¤2ï¼šæ£€æŸ¥åç«¯ -->
            <div class="section">
                <h2>æ­¥éª¤2ï¼šæ£€æŸ¥åç«¯éƒ¨ç½²</h2>
                <div class="input-group">
                    <label>åç«¯åœ°å€ï¼ˆRailwayåœ°å€ï¼‰ï¼š</label>
                    <input type="text" id="backendUrl" placeholder="https://your-project.up.railway.app">
                </div>
                <button class="btn" onclick="checkBackend()">æ£€æŸ¥åç«¯</button>
                <div id="backendResult" class="result"></div>
            </div>

            <!-- æ­¥éª¤3ï¼šæ£€æŸ¥APIè¿æ¥ -->
            <div class="section">
                <h2>æ­¥éª¤3ï¼šæ£€æŸ¥APIè¿æ¥</h2>
                <div class="input-group">
                    <label>APIåŸºç¡€åœ°å€ï¼š</label>
                    <input type="text" id="apiUrl" placeholder="https://your-backend.up.railway.app/api">
                </div>
                <button class="btn" onclick="checkAPI()">æ£€æŸ¥API</button>
                <div id="apiResult" class="result"></div>
            </div>

            <!-- æ­¥éª¤4ï¼šç¯å¢ƒå˜é‡é…ç½®æŒ‡å— -->
            <div class="section">
                <h2>æ­¥éª¤4ï¼šç¯å¢ƒå˜é‡é…ç½®æŒ‡å—</h2>
                <div id="envGuide"></div>
                <button class="btn" onclick="generateEnvGuide()">ç”Ÿæˆé…ç½®æŒ‡å—</button>
            </div>

            <!-- å¸¸è§é—®é¢˜ -->
            <div class="section">
                <h2>ğŸ“š å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ</h2>
                <div class="step">
                    <h3>é—®é¢˜1ï¼šå‰ç«¯æ˜¾ç¤ºç©ºç™½é¡µé¢</h3>
                    <ol>
                        <li>æ£€æŸ¥Verceléƒ¨ç½²æ—¥å¿—ï¼Œç¡®è®¤æ„å»ºæˆåŠŸ</li>
                        <li>ç¡®è®¤ <code>vercel.json</code> é…ç½®æ­£ç¡®</li>
                        <li>æ¸…é™¤æµè§ˆå™¨ç¼“å­˜åé‡è¯•</li>
                    </ol>
                </div>
                <div class="step">
                    <h3>é—®é¢˜2ï¼šAPIè¯·æ±‚è¿”å›404</h3>
                    <ol>
                        <li>ç¡®è®¤ <code>VITE_API_URL</code> ç¯å¢ƒå˜é‡å·²è®¾ç½®</li>
                        <li>ç¡®è®¤ç¯å¢ƒå˜é‡å€¼æ ¼å¼æ­£ç¡®ï¼ˆä»¥ <code>/api</code> ç»“å°¾ï¼‰</li>
                        <li><strong>é‡è¦ï¼š</strong>ç¯å¢ƒå˜é‡æ›´æ”¹åå¿…é¡»é‡æ–°éƒ¨ç½²å‰ç«¯</li>
                    </ol>
                </div>
                <div class="step">
                    <h3>é—®é¢˜3ï¼šCORSé”™è¯¯</h3>
                    <ol>
                        <li>åœ¨åç«¯æ·»åŠ  <code>FRONTEND_URL</code> ç¯å¢ƒå˜é‡</li>
                        <li>ç¡®è®¤åç«¯CORSé…ç½®åŒ…å«å‰ç«¯åœ°å€</li>
                        <li>é‡æ–°éƒ¨ç½²åç«¯æœåŠ¡</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <script>
        async function checkFrontend() {
            const url = document.getElementById('frontendUrl').value.trim();
            const resultDiv = document.getElementById('frontendResult');
            
            if (!url) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = 'âŒ è¯·è¾“å…¥å‰ç«¯åœ°å€';
                return;
            }

            resultDiv.className = 'result info';
            resultDiv.innerHTML = 'â³ æ­£åœ¨æ£€æŸ¥å‰ç«¯...';

            try {
                const response = await fetch(url, { method: 'HEAD', mode: 'no-cors' });
                resultDiv.className = 'result success';
                resultDiv.innerHTML = `
                    âœ… å‰ç«¯å¯ä»¥è®¿é—®<br>
                    <strong>åœ°å€ï¼š</strong> ${url}<br>
                    <strong>ä¸‹ä¸€æ­¥ï¼š</strong> æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®
                `;
            } catch (error) {
                // ç”±äºCORSé™åˆ¶ï¼Œå³ä½¿æˆåŠŸä¹Ÿå¯èƒ½æŠ¥é”™
                resultDiv.className = 'result warning';
                resultDiv.innerHTML = `
                    âš ï¸ æ— æ³•ç›´æ¥æ£€æµ‹ï¼ˆCORSé™åˆ¶ï¼‰<br>
                    <strong>å»ºè®®ï¼š</strong> åœ¨æµè§ˆå™¨ä¸­æ‰‹åŠ¨è®¿é—® ${url}<br>
                    <strong>æ£€æŸ¥ï¼š</strong> æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ŒæŸ¥çœ‹Consoleæ ‡ç­¾
                `;
            }
        }

        async function checkBackend() {
            const url = document.getElementById('backendUrl').value.trim();
            const resultDiv = document.getElementById('backendResult');
            
            if (!url) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = 'âŒ è¯·è¾“å…¥åç«¯åœ°å€';
                return;
            }

            resultDiv.className = 'result info';
            resultDiv.innerHTML = 'â³ æ­£åœ¨æ£€æŸ¥åç«¯...';

            try {
                const healthUrl = url.endsWith('/') ? url + 'health' : url + '/health';
                const response = await fetch(healthUrl);
                
                if (response.ok) {
                    const data = await response.json();
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `
                        âœ… åç«¯æœåŠ¡æ­£å¸¸è¿è¡Œ<br>
                        <strong>çŠ¶æ€ï¼š</strong> ${data.status || 'OK'}<br>
                        <strong>æ•°æ®åº“ï¼š</strong> ${data.database || 'æœªçŸ¥'}<br>
                        <strong>ç¯å¢ƒï¼š</strong> ${data.environment || 'æœªçŸ¥'}
                    `;
                } else {
                    resultDiv.className = 'result warning';
                    resultDiv.innerHTML = `
                        âš ï¸ åç«¯å“åº”å¼‚å¸¸<br>
                        <strong>çŠ¶æ€ç ï¼š</strong> ${response.status}<br>
                        <strong>å»ºè®®ï¼š</strong> æ£€æŸ¥åç«¯éƒ¨ç½²æ—¥å¿—
                    `;
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `
                    âŒ æ— æ³•è¿æ¥åˆ°åç«¯<br>
                    <strong>é”™è¯¯ï¼š</strong> ${error.message}<br>
                    <strong>å¯èƒ½åŸå› ï¼š</strong><br>
                    â€¢ åç«¯æœåŠ¡æœªè¿è¡Œ<br>
                    â€¢ åç«¯åœ°å€é”™è¯¯<br>
                    â€¢ ç½‘ç»œè¿æ¥é—®é¢˜
                `;
            }
        }

        async function checkAPI() {
            const url = document.getElementById('apiUrl').value.trim();
            const resultDiv = document.getElementById('apiResult');
            
            if (!url) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = 'âŒ è¯·è¾“å…¥APIåœ°å€';
                return;
            }

            resultDiv.className = 'result info';
            resultDiv.innerHTML = 'â³ æ­£åœ¨æ£€æŸ¥APIè¿æ¥...';

            try {
                const statsUrl = url.endsWith('/') ? url + 'stats' : url + '/stats';
                const response = await fetch(statsUrl);
                
                if (response.ok) {
                    const data = await response.json();
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `
                        âœ… APIè¿æ¥æˆåŠŸ<br>
                        <strong>APIåœ°å€ï¼š</strong> ${url}<br>
                        <strong>å“åº”ï¼š</strong> ${data.success ? 'æˆåŠŸ' : 'å¤±è´¥'}<br>
                        <strong>ä¸‹ä¸€æ­¥ï¼š</strong> åœ¨å‰ç«¯é…ç½®æ­¤APIåœ°å€
                    `;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = `
                        âŒ APIè¯·æ±‚å¤±è´¥<br>
                        <strong>çŠ¶æ€ç ï¼š</strong> ${response.status}<br>
                        <strong>å¯èƒ½åŸå› ï¼š</strong><br>
                        â€¢ APIè·¯å¾„é”™è¯¯<br>
                        â€¢ åç«¯è·¯ç”±é…ç½®é—®é¢˜<br>
                        â€¢ æ•°æ®åº“æœªè¿æ¥
                    `;
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `
                    âŒ æ— æ³•è¿æ¥åˆ°API<br>
                    <strong>é”™è¯¯ï¼š</strong> ${error.message}<br>
                    <strong>æ£€æŸ¥æ¸…å•ï¼š</strong><br>
                    â€¢ ç¡®è®¤åç«¯å·²éƒ¨ç½²å¹¶è¿è¡Œ<br>
                    â€¢ ç¡®è®¤APIåœ°å€æ ¼å¼æ­£ç¡®ï¼ˆä»¥ /api ç»“å°¾ï¼‰<br>
                    â€¢ æ£€æŸ¥CORSé…ç½®
                `;
            }
        }

        function generateEnvGuide() {
            const frontendUrl = document.getElementById('frontendUrl').value.trim();
            const backendUrl = document.getElementById('backendUrl').value.trim();
            const guideDiv = document.getElementById('envGuide');

            if (!frontendUrl || !backendUrl) {
                guideDiv.innerHTML = '<div class="result error">âŒ è¯·å…ˆå¡«å†™å‰ç«¯å’Œåç«¯åœ°å€</div>';
                return;
            }

            const apiUrl = backendUrl.endsWith('/') ? backendUrl + 'api' : backendUrl + '/api';

            guideDiv.innerHTML = `
                <div class="result info">
                    <h3>ğŸ“ Vercelç¯å¢ƒå˜é‡é…ç½®</h3>
                    <div class="step">
                        <strong>æ­¥éª¤ï¼š</strong>
                        <ol>
                            <li>è®¿é—® <a href="https://vercel.com/dashboard" target="_blank">Vercel Dashboard</a></li>
                            <li>é€‰æ‹©æ‚¨çš„å‰ç«¯é¡¹ç›®</li>
                            <li>è¿›å…¥ Settings â†’ Environment Variables</li>
                            <li>æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š</li>
                        </ol>
                    </div>
                    <div class="code-block">
Name: VITE_API_URL
Value: ${apiUrl}
                    </div>
                    <div class="step">
                        <strong>é‡è¦æç¤ºï¼š</strong>
                        <ul>
                            <li>å˜é‡åå¿…é¡»æ˜¯ <code>VITE_API_URL</code>ï¼ˆæ³¨æ„VITEå‰ç¼€ï¼‰</li>
                            <li>å€¼å¿…é¡»ä»¥ <code>/api</code> ç»“å°¾</li>
                            <li>å¿…é¡»é€‰æ‹©æ‰€æœ‰ç¯å¢ƒï¼ˆProduction, Preview, Developmentï¼‰</li>
                            <li><strong>ä¿å­˜åå¿…é¡»é‡æ–°éƒ¨ç½²å‰ç«¯æ‰èƒ½ç”Ÿæ•ˆï¼</strong></li>
                        </ul>
                    </div>
                </div>
                <div class="result info" style="margin-top: 15px;">
                    <h3>ğŸ“ Railwayç¯å¢ƒå˜é‡é…ç½®</h3>
                    <div class="step">
                        <strong>æ­¥éª¤ï¼š</strong>
                        <ol>
                            <li>è®¿é—® <a href="https://railway.app/dashboard" target="_blank">Railway Dashboard</a></li>
                            <li>é€‰æ‹©æ‚¨çš„åç«¯é¡¹ç›®</li>
                            <li>è¿›å…¥ Variables æ ‡ç­¾</li>
                            <li>æ·»åŠ æˆ–æ›´æ–°ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š</li>
                        </ol>
                    </div>
                    <div class="code-block">
FRONTEND_URL=${frontendUrl}
CORS_ORIGIN=${frontendUrl}
                    </div>
                    <div class="step">
                        <strong>æç¤ºï¼š</strong>
                        <ul>
                            <li>Railwayä¼šè‡ªåŠ¨æ£€æµ‹ç¯å¢ƒå˜é‡æ›´æ”¹å¹¶é‡æ–°éƒ¨ç½²</li>
                            <li>ç¡®ä¿ <code>FRONTEND_URL</code> ä¸æ‚¨çš„å‰ç«¯åœ°å€å®Œå…¨ä¸€è‡´</li>
                        </ul>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>

